{% extends '@SurvosPixie/pixie/layout.html.twig' %}

{% block title %}Hello !{% endblock %}

{% block body %}

    <details>
        <summary>Row data</summary>
    </details>

    <h1>{{ pixieCode }}.{{ tableName }} {{ key }}</h1>

<div class="row">
    <div class="col-md-6">
        {% for imageField in ['thumbnail','is_shown_by'] %}
            {% set value = attribute(row,imageField) %}
            {% if value %}
            <img src="{{ value }}" class="thumbnail" style="max-width: 300px" />
            <br /><b>{{ value }}</b>
            {% endif %}
        {% endfor %}
        IMAGE
    </div>
    <div class="col-md-6">
        {% with {data: row.data} %}
        {{ block('details') }}
        {% endwith %}
    </div>
</div>
{{ block('debug') }}
    {% if workflowEnabled and is_granted('ROLE_ADMIN')%}
        Workflow: {{ workflow }}

        {{ include('@SurvosWorkflow/_entity_transitions.html.twig', {
            transition_path: 'pixie_transition',
            flowName: workflow,
            entity: row
        }) }}

    {% endif %}

{% endblock %}

{% block details %}
    {% for var in ['id','code','object_number'] %}
        <div class="primitives">
        {% set value = attribute(data,var)|default(false) %}
        {% if value %}
            <b>{{ var }}</b><i>{{ value }}</i>
        {% endif %}
    {% endfor %}
        </div>

        {% for var in ['label','description'] %}
            <div class="fields-text">
                <code>{{ var }}</code>
                <div class="text-muted">{{ attribute(data,var)|default(false) }}</div>
            </div>
        {% endfor %}

    {% for var in ['dynasty','reign','culture','style','medium'] %}
        {% set value = attribute(data,var)|default(false) %}
        {% if value %}
        <div class="fields-text">
            <code>{{ var }}</code>
            <span class="text-success">{{ value }}</span>
        </div>
        {% endif %}
    {% endfor %}


{% endblock %}

{% block debug %}
    <h1>Debug information, mostly for checking fields</h1>
    {{ include(["pixie/%s/%s.html.twig"|format(pixieCode, tableName),  "pixie/%s.html.twig"|format(pixieCode)], {
        item: row,
        data: row.data,
        kv: kv|default(null)
    }, ignore_missing=true)  }}

    {% if row %}
        <h3>{{ tableName }} Properties</h3>
        <twig:simple_item_grid
                exclude="_raw,_att,_extra,value"
                :data="row.data"
        >

        </twig:simple_item_grid>


        {% if row._att|default(false) %}
            <h3>._att</h3>
            <twig:simple_item_grid
                    :data="row._att|json_decode(true)"
            />
        {% endif %}
        {% if row._raw|default(false) %}
            <h3>._raw</h3>
            <twig:simple_item_grid
                    :data="row._raw|json_decode(true)"
            />
        {% endif %}
        {% if row.value|default(false) %}
            <h3>.value</h3>
            <twig:simple_item_grid
                    :data="row.value|json_decode(true)"
            />
        {% endif %}
    {% endif %}



{#        <twig:simple_datatables#}
{#                :caller="_self"#}
{#                :columns="columns"#}
{#                :data="row"#}
{#        >#}
{#                <twig:block name="key">#}
{#                    <a href="{{ path('pixie_show_record', {#}
{#                        pixieName: pixieName,#}
{#                        tableName: tableName,#}
{#                        key: row[keyName]#}
{#                    }) }}"> {{ row[keyName] }}</a>#}
{#                </twig:block>#}
{#            <twig:block name="value">#}
{#                <a href="">{{ row.value|default('~~') }}</a>#}
{#            </twig:block>#}

{#        </twig:simple_datatables>#}



{% endblock %}
